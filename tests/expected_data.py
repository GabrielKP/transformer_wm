import pytest


@pytest.fixture
def expected_input_data():
    from torch import tensor

    return {
        "sequenceID": [0, 3, 6],
        "experimentID": [0, 1, 2],
        "sentenceID": ["01c71758aa01c71758aa", "86e2779fdc86e2779fdc", "a8664cee18a8664cee18"],
        "vignetteID": [0, 0, 0],
        "one_hots": [
            tensor(
                [
                    [
                        50256,
                        7413,
                        262,
                        3249,
                        11,
                        5335,
                        2630,
                        866,
                        262,
                        1708,
                        6827,
                        25,
                        1169,
                        2665,
                        319,
                        1459,
                        11926,
                        6673,
                        2147,
                        284,
                        262,
                        7508,
                        764,
                        3260,
                        262,
                        3249,
                        11,
                        5335,
                        1718,
                        257,
                        2270,
                        13,
                        2293,
                        673,
                        1392,
                        736,
                        11,
                        673,
                        1100,
                        262,
                        6827,
                        757,
                        25,
                        1169,
                        2665,
                        319,
                        1459,
                        11926,
                        6673,
                        2147,
                        284,
                        262,
                        7508,
                        764,
                        50256,
                    ]
                ]
            ),
            tensor(
                [
                    [
                        50256,
                        7413,
                        262,
                        3249,
                        11,
                        5335,
                        2630,
                        866,
                        262,
                        1708,
                        6827,
                        25,
                        1169,
                        2779,
                        286,
                        262,
                        6832,
                        4909,
                        5068,
                        2272,
                        837,
                        1390,
                        734,
                        10808,
                        837,
                        257,
                        22727,
                        2607,
                        357,
                        45985,
                        22727,
                        1267,
                        837,
                        257,
                        3315,
                        15760,
                        837,
                        290,
                        41900,
                        837,
                        981,
                        262,
                        7346,
                        1989,
                        481,
                        3473,
                        286,
                        1171,
                        14860,
                        837,
                        12437,
                        290,
                        27702,
                        9029,
                        764,
                        3260,
                        262,
                        3249,
                        11,
                        5335,
                        1718,
                        257,
                        2270,
                        13,
                        2293,
                        673,
                        1392,
                        736,
                        11,
                        673,
                        1100,
                        262,
                        6827,
                        757,
                        25,
                        1169,
                        2779,
                        286,
                        262,
                        6832,
                        4909,
                        5068,
                        2272,
                        837,
                        1390,
                        734,
                        10808,
                        837,
                        257,
                        22727,
                        2607,
                        357,
                        45985,
                        22727,
                        1267,
                        837,
                        257,
                        3315,
                        15760,
                        837,
                        290,
                        41900,
                        837,
                        981,
                        262,
                        7346,
                        1989,
                        481,
                        3473,
                        286,
                        1171,
                        14860,
                        837,
                        12437,
                        290,
                        27702,
                        9029,
                        764,
                        50256,
                    ]
                ]
            ),
            tensor(
                [
                    [
                        50256,
                        7413,
                        262,
                        3249,
                        11,
                        5335,
                        2630,
                        866,
                        262,
                        1708,
                        6827,
                        25,
                        1169,
                        8513,
                        12291,
                        1871,
                        262,
                        20547,
                        11557,
                        422,
                        1180,
                        4113,
                        357,
                        767,
                        12,
                        23,
                        1267,
                        5732,
                        262,
                        8722,
                        286,
                        5922,
                        18336,
                        1028,
                        340,
                        764,
                        3260,
                        262,
                        3249,
                        11,
                        5335,
                        1718,
                        257,
                        2270,
                        13,
                        2293,
                        673,
                        1392,
                        736,
                        11,
                        673,
                        1100,
                        262,
                        6827,
                        757,
                        25,
                        1169,
                        8513,
                        12291,
                        1871,
                        262,
                        20547,
                        11557,
                        422,
                        1180,
                        4113,
                        357,
                        767,
                        12,
                        23,
                        1267,
                        5732,
                        262,
                        8722,
                        286,
                        5922,
                        18336,
                        1028,
                        340,
                        764,
                        50256,
                    ]
                ]
            ),
        ],
        "sectionIDs": [
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
                3,
            ],
        ],
        "positionIDs": [
            [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
            ],
            [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                43,
            ],
            [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
            ],
        ],
        "subtokIDs": [
            [
                -2,
                1,
                2,
                3,
                -1,
                4,
                5,
                6,
                7,
                8,
                9,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                0,
                1,
                2,
                -1,
                3,
                4,
                5,
                6,
                -1,
                7,
                8,
                9,
                10,
                -1,
                11,
                12,
                13,
                14,
                15,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                -2,
            ],
            [
                -2,
                1,
                2,
                3,
                -1,
                4,
                5,
                6,
                7,
                8,
                9,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                0,
                1,
                2,
                -1,
                3,
                4,
                5,
                6,
                -1,
                7,
                8,
                9,
                10,
                -1,
                11,
                12,
                13,
                14,
                15,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                -2,
            ],
            [
                -2,
                1,
                2,
                3,
                -1,
                4,
                5,
                6,
                7,
                8,
                9,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                -1,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                0,
                1,
                2,
                -1,
                3,
                4,
                5,
                6,
                -1,
                7,
                8,
                9,
                10,
                -1,
                11,
                12,
                13,
                14,
                15,
                -1,
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                -1,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                -2,
            ],
        ],
        "tokens": [
            [
                "<|endoftext|>",
                " Before",
                " the",
                " meeting",
                ",",
                " Mary",
                " wrote",
                " down",
                " the",
                " following",
                " sentence",
                ":",
                "the",
                " section",
                " on",
                " current",
                " routes",
                " adds",
                " nothing",
                " to",
                " the",
                " info",
                ".",
                "After",
                " the",
                " meeting",
                ",",
                " Mary",
                " took",
                " a",
                " break",
                ".",
                " After",
                " she",
                " got",
                " back",
                ",",
                " she",
                " read",
                " the",
                " sentence",
                " again",
                ":",
                "the",
                " section",
                " on",
                " current",
                " routes",
                " adds",
                " nothing",
                " to",
                " the",
                " info",
                ".",
                "<|endoftext|>",
            ],
            [
                "<|endoftext|>",
                " Before",
                " the",
                " meeting",
                ",",
                " Mary",
                " wrote",
                " down",
                " the",
                " following",
                " sentence",
                ":",
                "the",
                " base",
                " of",
                " the",
                " buildings",
                " contains",
                " commercial",
                " space",
                ",",
                " including",
                " two",
                " restaurants",
                ",",
                " a",
                " dental",
                " office",
                " (",
                " pinnacle",
                " dental",
                " )",
                ",",
                " a",
                " medical",
                " clinic",
                ",",
                " and",
                " spa",
                ",",
                " while",
                " the",
                " surrounding",
                " area",
                " will",
                " consist",
                " of",
                " public",
                " parks",
                ",",
                " shops",
                " and",
                " recreation",
                " spaces",
                ".",
                "After",
                " the",
                " meeting",
                ",",
                " Mary",
                " took",
                " a",
                " break",
                ".",
                " After",
                " she",
                " got",
                " back",
                ",",
                " she",
                " read",
                " the",
                " sentence",
                " again",
                ":",
                "the",
                " base",
                " of",
                " the",
                " buildings",
                " contains",
                " commercial",
                " space",
                ",",
                " including",
                " two",
                " restaurants",
                ",",
                " a",
                " dental",
                " office",
                " (",
                " pinnacle",
                " dental",
                " )",
                ",",
                " a",
                " medical",
                " clinic",
                ",",
                " and",
                " spa",
                ",",
                " while",
                " the",
                " surrounding",
                " area",
                " will",
                " consist",
                " of",
                " public",
                " parks",
                ",",
                " shops",
                " and",
                " recreation",
                " spaces",
                ".",
                "<|endoftext|>",
            ],
            [
                "<|endoftext|>",
                " Before",
                " the",
                " meeting",
                ",",
                " Mary",
                " wrote",
                " down",
                " the",
                " following",
                " sentence",
                ":",
                "the",
                " genetic",
                " variation",
                " among",
                " the",
                " viruses",
                " isolated",
                " from",
                " different",
                " places",
                " (",
                " 7",
                "-",
                "8",
                " )",
                " increases",
                " the",
                " difficulty",
                " of",
                " developing",
                " vaccines",
                " against",
                " it",
                ".",
                "After",
                " the",
                " meeting",
                ",",
                " Mary",
                " took",
                " a",
                " break",
                ".",
                " After",
                " she",
                " got",
                " back",
                ",",
                " she",
                " read",
                " the",
                " sentence",
                " again",
                ":",
                "the",
                " genetic",
                " variation",
                " among",
                " the",
                " viruses",
                " isolated",
                " from",
                " different",
                " places",
                " (",
                " 7",
                "-",
                "8",
                " )",
                " increases",
                " the",
                " difficulty",
                " of",
                " developing",
                " vaccines",
                " against",
                " it",
                ".",
                "<|endoftext|>",
            ],
        ],
    }


@pytest.fixture
def expected_output_data():
    import math

    return {
        "sequence_ppls": [29.66311265659131, 13.370136218425351, 21.57166526048376],
        "surprisals": [
            [
                math.nan,
                12.528436660766602,
                2.4726860523223877,
                6.759099960327148,
                0.9914669990539551,
                8.550335884094238,
                6.019662857055664,
                4.49652099609375,
                1.2372334003448486,
                4.111489772796631,
                5.457304000854492,
                0.5898817181587219,
                11.55339241027832,
                8.894102096557617,
                2.520582437515259,
                8.978076934814453,
                10.1799955368042,
                8.477109909057617,
                5.094740867614746,
                0.9860860705375671,
                0.515897810459137,
                8.932909965515137,
                6.852960109710693,
                9.193811416625977,
                0.8854623436927795,
                0.09088589251041412,
                0.15147610008716583,
                0.6543557047843933,
                5.2418646812438965,
                1.5528600215911865,
                2.8072195053100586,
                2.4091033935546875,
                3.345977783203125,
                3.0256268978118896,
                2.6249682903289795,
                1.3381974697113037,
                2.0484509468078613,
                0.49368754029273987,
                3.7765583992004395,
                1.2716394662857056,
                4.491078853607178,
                1.8022089004516602,
                1.4959794282913208,
                3.365636110305786,
                0.4643537402153015,
                0.08500517904758453,
                0.17900297045707703,
                0.0705324113368988,
                0.4204546809196472,
                0.04947357997298241,
                0.0053550610318779945,
                0.008086560294032097,
                0.04600480571389198,
                0.6887087225914001,
                2.77083158493042,
            ],
            [
                math.nan,
                12.528436660766602,
                2.4726860523223877,
                6.759099960327148,
                0.9914669990539551,
                8.550335884094238,
                6.019662857055664,
                4.49652099609375,
                1.2372334003448486,
                4.111489772796631,
                5.457304000854492,
                0.5898817181587219,
                11.55339241027832,
                9.537511825561523,
                1.596375823020935,
                0.9304247498512268,
                8.974642753601074,
                7.844465732574463,
                10.591865539550781,
                3.2938671112060547,
                6.018650054931641,
                4.25555419921875,
                4.163260459899902,
                4.511398792266846,
                2.1919703483581543,
                1.465361475944519,
                9.08216667175293,
                1.6761562824249268,
                4.462790012359619,
                16.108627319335938,
                7.229938507080078,
                3.7037720680236816,
                2.564253807067871,
                1.0048134326934814,
                4.373061180114746,
                1.3656312227249146,
                0.9247760772705078,
                1.1270538568496704,
                9.165580749511719,
                1.9377422332763672,
                4.783768653869629,
                0.44752374291419983,
                5.149517059326172,
                1.0658957958221436,
                5.260239124298096,
                3.9953956604003906,
                0.12730051577091217,
                4.7980523109436035,
                2.961566209793091,
                1.7245591878890991,
                7.0044403076171875,
                1.8773627281188965,
                3.9890007972717285,
                2.4825799465179443,
                1.3420032262802124,
                7.749934196472168,
                0.6521531343460083,
                0.08325754106044769,
                0.1472310870885849,
                0.5195621252059937,
                5.578453540802002,
                1.6698249578475952,
                3.079345941543579,
                3.697840452194214,
                3.137227773666382,
                3.281785011291504,
                3.1969897747039795,
                1.7904976606369019,
                2.2018485069274902,
                0.462541401386261,
                4.176283836364746,
                1.424074649810791,
                4.265161037445068,
                2.6222381591796875,
                1.6627111434936523,
                3.101663589477539,
                0.8581470251083374,
                0.018463997170329094,
                0.021695192903280258,
                0.04582695662975311,
                0.10579777508974075,
                0.4275263249874115,
                0.004257187247276306,
                0.6017045974731445,
                0.01039047259837389,
                0.047878943383693695,
                0.05600164830684662,
                0.03851697966456413,
                0.0009813260985538363,
                0.005517255049198866,
                0.0003250309091527015,
                0.024676771834492683,
                3.467111587524414,
                0.061657533049583435,
                0.07083697617053986,
                0.029934503138065338,
                0.0017855905462056398,
                0.0038998278323560953,
                0.001880188356153667,
                0.003955161664634943,
                0.0011503038695082068,
                0.030130814760923386,
                0.024402489885687828,
                0.01136613916605711,
                0.0010935047175735235,
                0.002045564353466034,
                0.0032434258610010147,
                0.002657931065186858,
                0.008531078696250916,
                0.0004170263418927789,
                0.0021592890843749046,
                0.004123162943869829,
                0.02254253439605236,
                0.0032607740722596645,
                0.0025142983067780733,
                0.0022130541037768126,
                0.0089956009760499,
                0.8554626703262329,
                2.7026500701904297,
            ],
            [
                math.nan,
                12.528436660766602,
                2.4726860523223877,
                6.759099960327148,
                0.9914669990539551,
                8.550335884094238,
                6.019662857055664,
                4.49652099609375,
                1.2372334003448486,
                4.111489772796631,
                5.457304000854492,
                0.5898817181587219,
                11.55339241027832,
                12.005422592163086,
                6.217134475708008,
                4.717766761779785,
                1.561406135559082,
                8.105978965759277,
                7.762334823608398,
                0.7987275719642639,
                6.010205268859863,
                6.928117275238037,
                4.536211967468262,
                11.880537033081055,
                4.554542541503906,
                1.4092071056365967,
                1.4256665706634521,
                8.294337272644043,
                2.1343040466308594,
                7.2315592765808105,
                0.5549381971359253,
                4.916713714599609,
                4.538337230682373,
                2.230381727218628,
                5.899162292480469,
                3.9682369232177734,
                8.72797679901123,
                0.9426831603050232,
                0.1013563871383667,
                0.13700054585933685,
                0.9024825692176819,
                5.67315673828125,
                1.598520278930664,
                3.0753095149993896,
                2.957205057144165,
                3.270192861557007,
                3.084677219390869,
                2.9529190063476562,
                1.823344349861145,
                2.3639423847198486,
                0.36401885747909546,
                3.986973762512207,
                1.4544415473937988,
                4.341646671295166,
                2.165191650390625,
                1.667456030845642,
                2.829667329788208,
                1.0049304962158203,
                0.08447322249412537,
                0.05451922491192818,
                0.008497746661305428,
                0.0210864394903183,
                0.009474905207753181,
                0.001649211160838604,
                0.0048501696437597275,
                0.0018991068936884403,
                0.0735246017575264,
                3.0492918491363525,
                0.12116941064596176,
                0.005419917870312929,
                0.1818888783454895,
                0.02609989605844021,
                0.001867456827312708,
                0.0054444605484604836,
                0.0014573440421372652,
                0.005430351477116346,
                0.01622636988759041,
                0.0023405556567013264,
                0.03539350628852844,
                1.3605239391326904,
                2.7640905380249023,
            ],
        ],
    }
